# MinistryPath

**GitHub Repository**: https://github.com/riosaaron-sites/ReplitMinistryPathStages.git

## Overview
MinistryPath is a comprehensive church engagement and operations platform for Garden City Church. It provides a **Member & Volunteer Portal** for onboarding, surveys, training, serving, and gamified discipleship, and a **Leadership & Operations Portal** for managing people, ministries, requests, metrics, resources, and events. A core feature is a 123-question spiritual gifts survey. The platform aims for a low learning curve, minimal clicks, a clean mobile-friendly UI, and guided user flows. Mandatory profile completion gates access to all features. It is built as a full-stack TypeScript application with a React frontend and Express backend.

## User Preferences
Preferred communication style: Simple, everyday language.

## System Architecture

### UI/UX Decisions
- **Design System**: Shadcn/ui (New York style) based on Radix UI primitives with Tailwind CSS.
- **Theming**: Custom light/dark mode support.
- **Aesthetics**: Material Design foundation with a faith-centered warmth; Typography uses Inter and Crimson Pro from Google Fonts.

### Technical Implementations
- **Frontend**: React 18 with TypeScript, Vite, Wouter for routing, TanStack Query for server state.
- **Backend**: Express.js with TypeScript, Node's `http` module, custom middleware.
- **Authentication**: Replit Auth via OpenID Connect, `passport.js`, `express-session`, PostgreSQL session storage.
- **Form Architecture**: Multi-step survey with Likert scale, multiple choice, conditional logic, progress tracking, and client-side validation.
- **Onboarding Flow**: A 7-step guided experience that includes profile completion, leadership identification, ministry selection, faith commitment, and photo upload. Faith commitment pauses onboarding for pastoral follow-up if questions are raised.
- **Leadership Lock**: System for leaders to self-identify and be assigned as Primary Leaders to ministries during onboarding.
- **Scoring Engine**: Algorithms for spiritual gift scores, DISC profiles, ministry matches, technical skills, and Biblical Formation assessment, with sex-based filtering for certain ministries.
- **Biblical Formation Assessment**: A 20-question assessment across 4 categories with tiered scoring (Low, Developing, Strong), providing pastoral language, bucket breakdowns, and discipleship next steps.
- **Discipleship Pathway ("My Path")**: Structured as WORSHIP → NEXT NIGHT → LEARN → LOVE → LEAD, with progress tracked via a unified API.
- **Training Flow**: 3-step learning path (Lesson, Study Questions, Quiz) with content from AI-analyzed PDF manuals.
- **Email Automation**: Mailgun integration for sending automated emails with PDF results (generated by PDFKit) upon assessment completion.
- **Admin Tools**: CLI for managing and seeding ministry manuals; User Reset Tool with DRY RUN mode and confirmation phrase.
- **Built-in ADMIN Account**: System administrator account (username: ADMIN, password: ADMIN) with bypass mode for full system access during development. Seeded automatically on server startup with ID `00000000-0000-0000-0000-000000000001`.
- **Admin Bypass Mode**: Toggleable feature for admin/owner users that grants full access to all features regardless of role restrictions. Controlled via AdminBypassBanner component visible in both Member and Leadership portals.
- **Help Center**: Public-accessible help center with searchable articles, categories, view tracking, and admin content management.
- **Resources Library**: Authenticated, role-based, and ministry-based access to manuals by category.
- **Video-Ready Trainings**: Support for optional YouTube/Vimeo video URLs in training modules.
- **Organization Branding**: Customizable church branding elements and feature flags via Org settings.
- **Meeting Action Items**: Enhanced workboards with assignee tracking, priorities, due dates, status, and threaded comments.
- **Room Reservations**: Workflow with approval, resource tracking, leader approval rights, and database-level conflict detection.
- **Unified Calendar**: Combined view of meetings, events, and room reservations with filters and agenda presets. Supports admin-managed categories with color pickers and Outlook mapping.
- **Training Approval Workflow**: Quiz completion sets "submitted" status, requiring leader approval for completion and XP award. Supports ministry-scoped approval and admin override.
- **Meeting Email Functions**: Endpoints for sending agenda and recap emails via Mailgun, with fallback content for unconfigured Mailgun.
- **Outlook 365 Integration**: Full Microsoft Graph API integration for calendar sync and room booking, managed via an Admin Panel.
- **CoachBubble Component**: Reusable, persistent contextual help tips.
- **ConfirmDialog Component**: Reusable confirmation dialog for administrative actions with optional confirmation phrases.
- **Contextual Help Links**: Reusable HelpLink component with tooltips integrated across key pages.
- **Leader Notification System**: Automated email and in-app notifications for leaders regarding training submissions and team join requests.
- **System Status Panel**: Admin Panel displaying real-time health checks for Database, Email, and Outlook 365.
- **Profile Photo Upload**: User profile photo upload with client-side cropping and storage to Replit Object Storage via presigned URLs.
- **Bulk Invite System**: Allows single or bulk invitations with parsing for various formats, permission enforcement, duplicate checking, and comprehensive error reporting.
- **Weekly Ministry Metrics**: Per-ministry weekly metric submissions tracking attendance, volunteers, first-timers, altar responses, follow-ups, and qualitative notes (wins, concerns, next steps). Includes missing submissions view for admin/pastoral oversight and 8-week historical view.

### System Design Choices
- **API Design**: RESTful API for all core functionalities, including user management, surveys, ministries, training, gamification, and administrative functions.
- **Workboards**: Collaborative boards for 'meeting' (agenda, notes) and 'ministry' (projects) modes, with action items, priorities, due dates, and comments.
- **Serving Metrics**: Tracking with trend indicators, encouragement messages, and status calculations.
- **Member Feedback Loop**: Leaders can send encouragement notes visible on member dashboards.
- **Health Indicators**: Automated health scoring for team members (onboarding, training, serve rate, questions) with pastoral vocabulary statuses.
- **Ministry Expectations**: JSONB storage for ministry-specific expectations displayed to members.
- **Leader Oversight**: Sections for "Who I Report To" (members), "My Team" (leaders), and "Pastoral Care" (pastoral roles).
- **User Roles**: 7-tier role hierarchy: owner (100) > admin (90) > pastor (80) > leader (60) > member (40) > intern (30) > attendee (10).
- **Role Permission Groups**: Defined groups (OWNER_ROLES, ADMIN_ROLES, PASTORAL_ROLES, LEADERSHIP_ROLES) for access control, distinguishing administrative from pastoral authority.
- **Pastoral Questions**: Dedicated access for pastoral roles to follow up on "I Have Questions" from onboarding.
- **Ministry Join Requests**: Reviewable by leadership roles based on survey recommendations or interest.
- **Data Storage**: PostgreSQL via Neon serverless driver, Drizzle ORM, JSONB columns, UUID primary keys.
- **Database Migrations**: Drizzle Kit for schema management.
- **Build Strategy**: Vite for client, esbuild for server, deployed as a single Node process.

## External Dependencies
- **Replit Auth**: OpenID Connect provider for authentication.
- **Neon Database**: Serverless PostgreSQL hosting.
- **Mailgun**: Transactional email service.
- **Google Fonts**: Inter and Crimson Pro typefaces.
- **NPM Packages**: `@neondatabase/serverless`, `drizzle-orm`, `drizzle-kit`, `passport`, `openid-client`, `express-session`, `connect-pg-simple`, `@tanstack/react-query`, `@radix-ui/*`, `zod`, `ws`, `PDFKit`, `react-easy-crop`.
- **Microsoft Graph API**: For Outlook 365 calendar and room booking integration.